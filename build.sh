#!/bin/bash

build_src="lib/flavours/"
flavours=`ls -l $build_src | egrep '^d' | awk '{print $9}'`;

echo '=================================================================================================================';
echo '		>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Cleaning <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<';
echo '=================================================================================================================';
grunt clear;

for flavour in $flavours
do
	component_src="lib/flavours/"${flavour}"/";
	components=`ls -l $component_src | egrep '^d' | awk '{print $9}'`;

	for component in $components
		do
			echo '=================================================================================================================';
			echo '		>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Compiling Sass to CSS '${flavour} 'to '${component}' <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<';
			echo '=================================================================================================================';
			cd $component_src;
			sass --update $component:$component;
			cd -;
		done
done

for flavour in $flavours
do
	echo '=================================================================================================================';
	echo '		>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Building '${flavour}' <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<';
	echo '=================================================================================================================';
	grunt build-this -flavour=${flavour};
done

for flavour in $flavours
do
	component_src="lib/flavours/"${flavour}"/";
	components=`ls -l $component_src | egrep '^d' | awk '{print $9}'`;

	for component in $components
		do
			echo '=================================================================================================================';
			echo '		>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Building '${component}' of '${flavour}' <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<';
			echo '=================================================================================================================';
			grunt build-this -flavour=${flavour} -component=${component};
		done
done

for flavour in $flavours
do
	echo '=================================================================================================================';
	echo '		>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Building '${flavour}' <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<';
	echo '=================================================================================================================';
	grunt archive-this -flavour=${flavour};
done

for flavour in $flavours
do
	component_src="lib/flavours/"${flavour}"/";
	components=`ls -l $component_src | egrep '^d' | awk '{print $9}'`;

	for component in $components
		do
			echo '=================================================================================================================';
			echo '		>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Archiving '${component}' flavour of '${flavour}' <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<';
			echo '=================================================================================================================';
			grunt archive-this -flavour=${flavour} -component=${component};
		done
done